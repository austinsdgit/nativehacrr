#! /bin/bash
#
# This template will generated the variables needed for the live nativeha CRR deploy script
#
source ../setup.properties

echo "Logging into Cluster 1 to setup live QMgr"
#oc login https://api.67c20883d1ee7bb0b5beada0.am1.techzone.ibm.com:6443 -u student8 -p welcometoFSMpot
oc login https://api.itz-c7lcfw.infra01-lb.dal14.techzone.ibm.com:6443 -u kubeadmin -p GmWaQ-hTPsQ-SoGmY-ks8dw > /dev/null 2>&1

oc project occmq2
export HA_DIR_DEPLOY="nativeha-crr/deploy"
export TARGET_NAMESPACE=occmq2
export QMInstance=occmq2-mq02ha
export QMpre=mq02
export QMname=mq02ha
export ROUTE=occmq2-mq02ha-nativehachl-ibm-mq-qm
export CHLCAPS=MQ02HACHL
export CHANNEL=mq02hachl
export SC=ocs-external-storagecluster-ceph-rbd
export VERSION=9.4.2.0-r2
export LICENSE=L-QYVA-B365MB

export QM_KEY=LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSUpRUUlCQURBTkJna3Foa2lHOXcwQkFRRUZBQVNDQ1Nzd2dna25BZ0VBQW9JQ0FRRE5KS0tHbFR2T2xBWGgKV09XUFVURWtNZVZqRENZdDViMWs3Q3AzSG9JQUdKTjZiTEtpVDJlSFU3aFpoVk9VYTFBMFFEekxKdllySkxGRQo2dUx3ZzVYdE81dXlEbkdpMHkraEZzckhKRitUU0VyM3VEblBaQTNFV0Vxc1l4WVRCenVPT3d2VjhFL056Q2lECnhzVWtvek5WeEk2NW0yQWhJNkIyeVY5ZXJwdGtKMitwcXFkUnpBZC9sclRrWCswUzhRVEszTW85QXQ0RnlpSGEKQU1qRzFFaDJNZXFzRjM4T1ZQMnJONUtpQ1lHdDkvdUd6YjJnbGZQcHo5anpFcVNJQmhJMFZpR252YzV3ZFpsZgpXdVpSS2Z2dE9jTmlML2dMNjFBTUIwT3V6S3NQT0N0aU1jcStHc05zZ3ZjRW5oWmJQQjVZdjZvWGZhWWZ2UW5GClI4eWlTeTNVNjgybVJkYXhsYThBb0wzTEh0anNmSm5ucTEzSE1WRS9jcGx0cUU3OGZzcCtHRERWQUhBWUVNbmcKeFkxcVhuRlVyY1NoTWdpdEJkRjEyak1NRWsvSHZPdUhPT2N2V0JQcC9CRmN1emZNbDgvWjBTM0FtRlA2dklCRAoyeGJicGhjaHl6R1RReEw3ZGVuRTNaYlVLS2pIVWNTOVI2S29qd29laDNFc1ZXWFNvWXpWOWhqNUFxNk9uMmk3CjM2Z2hIYTBxQ1ZENXBGZ2hHbVRuWEtTUDRrdzRoc2hUbDEva1p4YUxrTnZXdktqenhrQXE2ckgrQU5OWUUyZ0kKMWlKMmtxQVBlcnA2NjFRM3RtK0IrT01qQjBnNlNGR21kQ2luTnY4L1RJdHJkYlVVbk9vRFk4bXozNHI4bXZjQwpkeU9ocU1GUEVGdnhxekNVczdjRm1vWmtOSkRLTHdJREFRQUJBb0lDQUJETEgvYnVmby9odEQySFhudUdCUVRXCmhOVy81OXc0QTNJZ2x6VmJMUDgvQTh1dzNFckhQMDFud0I2citIU2MrRnJlcTF0aUhDTGFCUjBFTVlISTg5d1EKMWlVVVk1OFZ0TDkyTXpGc085cTl2MDFhS25sYzBuZXhWcU9ZRlBXSDBRdEtzQ1JhWU40VENYb0lLcGxlTnRTZAptNlY4SDdsMnhpc1RQeGhzS05KaEhCWUNuMkhsMXZOTjdnOEgvMHRlcWFyRnVsU1dTSUNtMUhDWlFkWnRDR1dNCm5vNXArZis5VzJySnlObzA5d1c3MkQ1bjEwOHZGMkdibjBIKzA3TkM4L2lPMklCMzNFOStnUWk2VTBKdnNtencKSHB1S0c3ODJDejZBMWJ5WWlxUmJUOG5oRTV6T2FoTVhBWXZDT1VoTXVwcy9UWGhRMCttak93cUlYeXNtQm1GVApNZ0w3UXFwQjROSVhZR1N5cFZPSWFqTlRMTm9zMzZudVU3MzBpV0txL2FwNGdLN0FTT3RIUjBrZzN6TmNERHkwCnM5NExyRFZyKzRuY3grVjNVcW1rVTI1M0pNWUtiZGVsNjRDcTl1RVR5dkROb05IZ2VLV3luTVNhcjI4VHU3eDIKckFDb1AwTFVDSlduR2F0czhPd2NXNTZRVXJPeDk5OEx2bXBCQzdQeWNKSWZEaHI1dXIxOGMrN3BlQ0tuRDg2SApSaGppTWVMLzd4QjI1MS9VYTdNcEdVSmRSYUJsbzdrMFIxZVFabG8zMDNreFp4RjhjSDRGYjZKNFFEb3JyS1NKCkhTaW43TkY4ZWJRQ0R4R3VaeXk0K3huYm05QkcvS2xvQlVYQXJWazJYdEcxMi8yeEs0ZTY2Q0ZSME8wL0U4K1gKMG9RazdWdzNkS2lXU09lSTJDWEJBb0lCQVFEMlhSSWwxZ0VhNmpMdVRUaVY4RlhnQlJxM3h0Zjg0OE5ETk1vZgpRVmk1ZkFub0R5VTJLWmtwenBRMlhLN0w5VFUxa0pKZkdOcmRBVTdPSHRNQWdlRkJKeGkzczRjZnl1dkFLK0hlCm9zK1hCZUpqRUJ1Vk1DczZQUmhzZnN4SDB5TW1LM0Uxb3lQZllEdzg1UXJsbHFicngrREYxaXY3UlNkeFhQcDcKZ3ZNWkhtVTNKWTc5U3hrbEpoWmNKclhaRHRBYmlYUm14NVRRdE54cmVESkhPZUgyUFhaZ3UyeXZRSnI4bnRFbAoxNlAxbzN1MmFSeGVYcHVDa0tHejhhbXZuNDVGLzJiVXRMR1hHbjBPWTBuU2pjcWlDVmVTeGM1QU1PQmNMUlRoClRkZ093b05SVk00NURvaUNIdmZneEV2ekxLOFM3SGc2bFgwUHRsYm44TUd1RURYUEFvSUJBUURWS3M3eVdzMHQKMklNUENPRm9tbXQ4OVROaG5hVk9BdkZzNm1BTStVRkQrbk5TTWFqZmJmcHViQ0V0WnpiUUFzcUpadGNwR2RyVgpzVW1IOW9nSHV0encwQldnK0QyMDRRUEh5MllJN3JHVUl4N2RYSUxWVG82Qm5xNFBCQUdxWWZPT0RNd3l3VmF3Cjg5eUhWMjd6OEtDQkdvdDhvZmhldXFoZlFSaWlmVHlyU1ovRHdtaGIzVjFmRnV1dmk3aFNNaVkvY01PWG5mSjEKTThUOXJzbTkxUEplZyt4UWRTWURzeEQ2aEZGc1dwQXRHZ2tEVUozbWdFTVZJT1FiNkE5Y1dyb1lpM2ZjSmNkdQp1VCsyM2NSdE8xQVo5TU9Qd2pEZUk3ZWNsK1UxRDMybmZZZVVObWpkRUR5aElTSHNaTkc1aWM4YWxjcmUvNGR6CkdWbVM0SThGY1oyaEFvSUJBQS9BTjQ3UHRkWmdyc3pwaHZxZkdQNXZsUnUyek14UVM0V2FkR20zSmRNR0NTUWIKQThnSXROQWxjdmhleUpZbG9UZEJmUG96ZnBxdW9Ma3c0MUNlL1NYTE9CdFdrUWNKVkRVL0dQdkE4UUM0MFpaLwp5eU9vcHJyY2VSbEdxZ3pWaE9QRjEwRVVveEIrK0pyMEVkUkg0M2dqbVUxTXVoY2dmcnNTdExqODBFb0UxWGZICklQTTB2L0RPRkpQanJiQ283OGt5Nm93L3FsWUZtaW9NenpvYWkwWFEvQ2FIRlJYSFRhRmxEZjRiWVZJdEY1VzcKOXFKWjdodFUzK0cvUzVmODNYM0FMSFRnOEpHMmtkUS9xTktiV2g4dDlibGVpQ2MyZU1HcjZDL1hhRDdaVk1mNApZZzduelBaMHdHaFFaSUt4a3FmbEVuSzhaL2gvTWVNMlUwdXJvYVVDZ2dFQWNiTzAwUWJuL0hWSmF1S1V3U1BsCkE3RVNxQlhiajZINFB0MUJRSXBQYXNBVGRSc3g5WU9IR2hFcEhUdTV1L2hSS2pzbHR6R29UV1dVVUNhSzVueWcKenY1Zkd3NXVjNlcyUzRMTnVTUUFxb0NWUFFQVWNZekdiSk5FU3BRYmcxTmVBejRHU1doaElsL2hHSHZsbmM2UwovbW8zVHRKaVZiMEFoRmFIbWx4czJQeWJjR0twSVo4UTUrQ2s5R3oxY3pwMnRrNGl0aU8wcVJsbEVOK0Rrbk1jCm1KZUxuRnJ3WFBiTnJxS1hmOUZLcUJRRURMV2FrOUdFZHFlbHBORUNLSVBvVWFGSzNLMTJGRFJSck92Ymsxd1kKM005MjVKNXpUSG9HdlVzMElqcFNEdDNoVElnOUpQVTlNY0VuaEIwKzFOV1NGNThncUJQcW50VTl0eDk2aWkvUgpJUUtDQVFCYmFzdDBMRGJqclpVcE1qenlreDc1eXRnaHNDVDY0N0s3dEZuQlBXWGJuaTRKbXR5cDlUVlR1Y2M1Ck9MZGR3RVJWa3kwN0N3RWw1VUF3MWhrN0VWaGNUWjFYTjNOOWJmM0p5MklxRlFWcXpxNGdDajcxVnIzRzRIa0MKd2ZlWld0a2o4aHg3eXltMTVkUU51bU9wbjZzUFBNdm1Kb21oL3g5Qm5pVGlxRlRGcEk2R0VhTzU1b1MrZVBoYQp1MHgvQ3d2ZnEydXdDTVRQYW90eWE3bjJwTUlPOXVsWHJMa3pHbGVBUHpod3puQzdNMWdtcHBGL29oblZuNm13CkVkMXRyVWZpTnNmVjVYMGhTZTA4SlFRTzhzVC9sS0VqY1l3RVdGTHcxV0dSb3lTeW1GcHFnR0dxQ3NtSFBNUnIKMWNraWV0bnRraURrSjNUTmFQVTd5N0VOWUE4TQotLS0tLUVORCBQUklWQVRFIEtFWS0tLS0tCg==
export QM_CERT=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVxRENDQXBBQ0NRQzlGWjdYZFFGdFpqQU5CZ2txaGtpRzl3MEJBUTBGQURBWU1SWXdGQVlEVlFRRERBMXoKWld4bWMybG5ibVZrTFdOaE1CNFhEVEkxTURnd056SXdNelUwTlZvWERUSTJNRGd3TnpJd016VTBOVm93RkRFUwpNQkFHQTFVRUF3d0piWEV3TW1oaExYRnRNSUlDSWpBTkJna3Foa2lHOXcwQkFRRUZBQU9DQWc4QU1JSUNDZ0tDCkFnRUF6U1NpaHBVN3pwUUY0VmpsajFFeEpESGxZd3dtTGVXOVpPd3FkeDZDQUJpVGVteXlvazluaDFPNFdZVlQKbEd0UU5FQTh5eWIyS3lTeFJPcmk4SU9WN1R1YnNnNXhvdE12b1JiS3h5UmZrMGhLOTdnNXoyUU54RmhLckdNVwpFd2M3ampzTDFmQlB6Y3dvZzhiRkpLTXpWY1NPdVp0Z0lTT2dkc2xmWHE2YlpDZHZxYXFuVWN3SGY1YTA1Ri90CkV2RUV5dHpLUFFMZUJjb2gyZ0RJeHRSSWRqSHFyQmQvRGxUOXF6ZVNvZ21CcmZmN2hzMjlvSlh6NmMvWTh4S2sKaUFZU05GWWhwNzNPY0hXWlgxcm1VU243N1RuRFlpLzRDK3RRREFkRHJzeXJEemdyWWpIS3ZockRiSUwzQko0VwpXendlV0wrcUYzMm1INzBKeFVmTW9rc3QxT3ZOcGtYV3NaV3ZBS0M5eXg3WTdIeVo1NnRkeHpGUlAzS1piYWhPCi9IN0tmaGd3MVFCd0dCREo0TVdOYWw1eFZLM0VvVElJclFYUmRkb3pEQkpQeDd6cmh6am5MMWdUNmZ3UlhMczMKekpmUDJkRXR3SmhUK3J5QVE5c1cyNllYSWNzeGswTVMrM1hweE4yVzFDaW94MUhFdlVlaXFJOEtIb2R4TEZWbAowcUdNMWZZWStRS3VqcDlvdTkrb0lSMnRLZ2xRK2FSWUlScGs1MXlraitKTU9JYklVNWRmNUdjV2k1RGIxcnlvCjg4WkFLdXF4L2dEVFdCTm9DTllpZHBLZ0QzcTZldXRVTjdadmdmampJd2RJT2toUnBuUW9wemIvUDB5TGEzVzEKRkp6cUEyUEpzOStLL0pyM0FuY2pvYWpCVHhCYjhhc3dsTE8zQlpxR1pEU1F5aThDQXdFQUFUQU5CZ2txaGtpRwo5dzBCQVEwRkFBT0NBZ0VBanIyWGwrUkZCZzRrUXJ4ZlBPNHdINlNnWWpOOVY5Ym16Q0pUTnhJOHZpb29jQXVxCmY3YWUzdHkvWGZyV1dqMzVsMXk5ZVRpWEgxd0ttaHZTL0ZtYUp4c09LRXlaNG5IQk9sbWpjbnVQa2FPU1FqYnkKZkZDU2hyeTVVNFJSMzk3OTFZU3d1OEtIK1VFWUQzQ2kvWUQ2eElhRnBoMmRZc3RJZWJyM3E4ci9vckltSG56OQo2bHExZ2VhZFZycG1WdmZhWTNkM3JmSlBKdS9VTk02T3VhQXY4cDNFWmdpek10NXlzNk5abkhJcDljenpTdGgyClBwTnF4ZDVsLzJ5NUFFeEZMMHY1aFl0cmtIVUlwd08rTnhtMmFMOSsvVkNmTzhmbmNTVzNtVUJZY014YnZmSSsKRkRDb1I3OXlGdXNnTmhEWkxyRG03ZEtCNjBiV2pVdXFQNUNMcFZQME9LUDBhRHVXNXZZY1d6TEY5bUlnY3p2cwozSThybytnMUdTL3QxMldBZXNtaUp1SHBOK0haSWtmdTJzNUVzbkRyQ2pubnJUd0NvUWNJNjdqNE45NHB4RDV6CkY5R3p4eHRCYThGM2lWUWl0L1BtNVN3dWpJZXdkVEdRTkhxU3BZZkM0QUNraCtkenoydUV1ZGlpeUlYdkg2OGoKajZOcFdrR3pMWWZ5c2RTVkMvZEVIdkg1bzhjM3MySjBNOVpPNkdIUWFhZzBETU9aU0JISVNURHNvcWdtc2JhUwpod0t1d3h2czVVREsvK05TMUJ5ZWlEcUp0bU5KeW8yV2Y0ZzB1ZlpCaTlqS2pWbjB0OEZnYlI4UVFPcTV4ak5qCnRlaVo0OUd2bG1uL2NIclhHSTJoVUtKTFRmaXQ2L2lPdHVJV0NwL3pwZ3g3aUVqejlrY1dWUU5iL2pnPQotLS0tLUVORCBDRVJUSUZJQ0FURS0tLS0tCg==
export CA_CERT=LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUVyRENDQXBRQ0NRREdIU1liME1qaU96QU5CZ2txaGtpRzl3MEJBUTBGQURBWU1SWXdGQVlEVlFRRERBMXoKWld4bWMybG5ibVZrTFdOaE1CNFhEVEkxTURnd056SXdNelUwTkZvWERUSTJNRGd3TnpJd016VTBORm93R0RFVwpNQlFHQTFVRUF3d05jMlZzWm5OcFoyNWxaQzFqWVRDQ0FpSXdEUVlKS29aSWh2Y05BUUVCQlFBRGdnSVBBRENDCkFnb0NnZ0lCQU1MWm1GdTdrbU1yaG56ajEyVWczYVJOT3lwb2N1RWd1RXdtcXR3YzR6ejNqb3NOWWJTbTQ1eWoKOCtrRHNwWU4rcWdTUFFQeVhEVjFmd3RCRW9JYVE2TmoxbnFnVGphdHJ6aHFlOU0wZ1gvVzcvdFBRd3ZBWGNMMAo2bGhWOTJkWCtwdWI1Wk5UMXcwamVaYkZYM2V0YjRyUnMyWlZTUTM5VW94T1B3L1g4VDdSRktuMHNoNm5IMWVvCjkrSnBHNDE0Zmxqci8yRVZWMWtveHNYV2MxQXBjSkppU05oQnc4U1lCY094T2tabkw2bkxpTFNBOUtWRVJWMjMKeXlGOXpiY3dDSHl3dTJXUGd2endOR1lLTVc5MmFxdHIyMHk1Qkx4dXNYbUIzbTdtSDNnZ3Uxbzc4SlkrcTZoZwp6bGlEbGxlVU54RXBuYi9UeDUzaWNteGpkeFhUemQvQ0Zldk5yUW9iOEs0NFJRY1pKYmRWT0tHMVFIUXFRRVcvCnNnbnB1MTRoL1piVE80cktzWUI1NEJpRkV2aGdIOXFwcXBrczhyT0JQNWNoSllMQm1uZ1hvTmJVN3JhajJmcC8Ka0NkK1RnVkdFS3lxamFhbzViYmhTT3gwQWdCanoydU56NzJtNkt1cnZDMTl2T0pSQk1BYzliRkxwUDBEWkJFNQpiNTdIaE5Qbm5JVHVDM05QZysrYXMwekN3SENrdDZPWldFR3dyalR3UjVaSWJjUHFTbkNxV2ZpZ21ETDA2RzBDCmp4eWdpOXl2Q01SM0NjMWowRkMrNU1mTU9jMEdYd3dLRXFZS21LaWFIQ21XZmt6V1VzUXJkb0N3YzB5UHhXVzEKNFZmVEN4amZXNy9veVJRWndJd2kxMEtLQUpaTTl2U3NvQVRUSzhyZ3N1cGVXZDdqZysyTEFnTUJBQUV3RFFZSgpLb1pJaHZjTkFRRU5CUUFEZ2dJQkFEZS96MjNIZ2x3NEVkcHUySlMzNzQvWnFKbm9NU3lET0ZCU1g3RFBkRzhnCkVLSTl4bkd3OWN0WmVxcHlMcll1NXlIWG1YNkNPNXJFdzVILy9mSVdiNEhHNmtjVXZXalJIYVhEcVZmaDVuREIKbjZzZ2l6ZWJBd2dFcFY3ZG1uL1ZIVlY2TXVwcnNDaEFPMjk0dHNDY1dCUVYxMGxRREZ5Qi8vbVVmd05YdEJVVgoveEVzVWdRNFJxK0hXcE0yZUQ1M3lKbmh2d21pQUtLTHZmSXFrM3Zndlo2WFJHZWRIZXdFWjc4dkwveFBSdnZvCnZla0FXdG9lN0Q5QXlXQUNnTFYzOGZXdEFDcEo0UkhGTG1lNlk0NlhFOWtkVXF6dUVBTVI5alBCYlgvdnJTR3kKdDhoWkRISmFXdmVJTFVRdVFKY2lDanpwamlQcHdPcll0UUo0Q245UW9HWjRhTEh6VGg4S2NTMmZXOWtpNWVzNwpKazlOWUwwRW95WFA4K1ZPbWdnYzhyWThWbDZ2YmRMNjliQ0V1aXNLRmY3SEpUU05FNjcwTTRTWk1kYXA1NTl3CkRDZG1KSzBGTmVMcDVHcHZhU0lleHUvQkVKaCtSVTZVSHZwaEtSQjNqNmlmMUlsdTNxRjcrVG5kWGFlWFBjTDAKWE5uUVJ4VDNTY2lMcWNLV3NzZVM3dlBCdG1OS0xYVHBWWWxOTnpmN1pPckhnb3hCbnlESDNoSmsybEs2cEM1RApTRkNVa1F2MUdFSXdEUWNqRUwzSkV4NUdsWGlUNkwvaTRJajFYdHBZTFdORkFLZTc4WUFhaEI2TDY4NDlHTTUzClJHakVqbjlXbGp4MEorRm4vRVpFTTNJVzV1RjE5WUhHdGd5RkZyYU5jYzhoYmh2aXRXQm8rUlE2OFVrekp6T2kKLS0tLS1FTkQgQ0VSVElGSUNBVEUtLS0tLQo=

( echo "cat <<EOF" ; cat 1-live-template.yaml ; echo EOF ) | sh > 1-live-active.yaml

oc apply -f 1-live-active.yaml -n occmq2

# create kdb file
rm ../test/key.*
runmqakm -keydb -create -db ../test/key.kdb -type cms -pw passw0rd -stash
runmqakm -cert -add -db ../test/key.kdb -pw passw0rd -label ca -file certs/mq02ha-ca.crt
runmqakm -cert -add -db ../test/key.kdb -pw passw0rd -label nativeha -file certs/mq02ha.crt

